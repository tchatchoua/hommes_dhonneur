import{a as ee,n as te,o as ie,t as ne,y as oe}from"./chunk-X5J6KBJZ.js";import{a as $}from"./chunk-BYLLDUDU.js";import{$ as F,A as r,B as I,Ea as z,Ga as H,La as J,Qa as K,Sa as Q,V as y,W as M,X as O,Ya as W,Za as X,_ as d,_a as Z,aa as T,ca as k,da as R,ea as N,fa as V,h as C,ha as D,i as v,j as h,ka as L,l as s,m as x,n as E,o as u,p as _,qa as q,r as p,sa as B,ta as A,u as i,ua as j,v as n,va as G,w as m,x as b,xa as U,y as P,ya as Y,z as f}from"./chunk-CLQQFUUR.js";import"./chunk-B5Q7V33N.js";import"./chunk-7KGURMOZ.js";import"./chunk-MEY4KOAF.js";import"./chunk-K4BOZHCE.js";import"./chunk-VKOJ4YFE.js";import"./chunk-URA66MOF.js";import"./chunk-R5HL6L5F.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-L7HKPRYE.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as S,b as w}from"./chunk-JHI3MBHO.js";function ae(e,c){e&1&&(i(0,"ion-card",3)(1,"ion-card-content")(2,"ion-text")(3,"p"),r(4,"Invalid or expired invitation token. Please contact an administrator for a new invitation."),n()(),i(5,"ion-button",4),r(6," Back to Login "),n()()())}function re(e,c){e&1&&(i(0,"ion-note",10),r(1," Please enter a valid email "),n())}function le(e,c){e&1&&(i(0,"ion-note",10),r(1," Username must be at least 3 characters "),n())}function se(e,c){e&1&&(i(0,"ion-note",10),r(1," Password must be at least 8 characters "),n())}function me(e,c){if(e&1){let t=b();i(0,"ion-datetime",21),P("ionChange",function(l){C(t);let g=f(2);return v(g.onDateChange(l))}),n()}if(e&2){let t=f(2);_("max",t.maxDate)}}function de(e,c){e&1&&(i(0,"ion-note",10),r(1," Date of birth is required "),n())}function ce(e,c){if(e&1&&(i(0,"ion-text",3)(1,"p",22),r(2),n()()),e&2){let t=f(2);s(2),I(t.errorMessage())}}function ge(e,c){e&1&&m(0,"ion-spinner",18)}function ue(e,c){e&1&&(m(0,"ion-icon",23),r(1," Create Account "))}function pe(e,c){if(e&1){let t=b();i(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),r(3,"Create Account"),n()(),i(4,"ion-card-content")(5,"form",5),P("ngSubmit",function(){C(t);let l=f();return v(l.onSubmit())}),i(6,"div",6)(7,"ion-item"),m(8,"ion-input",7),n(),i(9,"ion-item"),m(10,"ion-input",8),n()(),i(11,"ion-item"),m(12,"ion-input",9),n(),u(13,re,2,0,"ion-note",10),i(14,"ion-item"),m(15,"ion-input",11),n(),u(16,le,2,0,"ion-note",10),i(17,"ion-item"),m(18,"ion-input",12),i(19,"ion-button",13),P("click",function(){C(t);let l=f();return v(l.togglePassword())}),m(20,"ion-icon",14),n()(),u(21,se,2,0,"ion-note",10),i(22,"ion-item")(23,"ion-label"),r(24,"Date of Birth"),n(),m(25,"ion-datetime-button",15),n(),i(26,"ion-modal",16),u(27,me,1,1,"ng-template"),n(),u(28,de,2,0,"ion-note",10)(29,ce,3,1,"ion-text",3),i(30,"ion-button",17),u(31,ge,1,0,"ion-spinner",18)(32,ue,2,0),n()(),i(33,"div",19)(34,"p"),r(35,"Already have an account?"),n(),i(36,"ion-button",4),m(37,"ion-icon",20),r(38," Sign In "),n()()()()}if(e&2){let t,o,l,g,a=f();s(5),_("formGroup",a.registerForm),s(8),p((t=a.registerForm.get("email"))!=null&&t.hasError("email")&&((t=a.registerForm.get("email"))!=null&&t.touched)?13:-1),s(3),p((o=a.registerForm.get("username"))!=null&&o.hasError("minlength")&&((o=a.registerForm.get("username"))!=null&&o.touched)?16:-1),s(2),_("type",a.showPassword()?"text":"password"),s(2),_("name",a.showPassword()?"eye-off-outline":"eye-outline"),s(),p((l=a.registerForm.get("password"))!=null&&l.hasError("minlength")&&((l=a.registerForm.get("password"))!=null&&l.touched)?21:-1),s(5),_("keepContentsMounted",!0),s(2),p((g=a.registerForm.get("dateOfBirth"))!=null&&g.hasError("required")&&((g=a.registerForm.get("dateOfBirth"))!=null&&g.touched)?28:-1),s(),p(a.errorMessage()?29:-1),s(),_("disabled",a.registerForm.invalid||a.isLoading()),s(),p(a.isLoading()?31:32)}}var Ie=(()=>{class e{fb;authService;router;route;registerForm;isLoading=h(!1);showPassword=h(!1);errorMessage=h("");invitationValid=h(null);invitationToken="";maxDate;constructor(t,o,l,g){this.fb=t,this.authService=o,this.router=l,this.route=g,ee({personAddOutline:oe,logInOutline:ne,eyeOutline:ie,eyeOffOutline:te});let a=new Date;a.setFullYear(a.getFullYear()-13),this.maxDate=a.toISOString(),this.registerForm=this.fb.group({firstName:["",[d.required]],lastName:["",[d.required]],email:["",[d.required,d.email]],username:["",[d.required,d.minLength(3)]],password:["",[d.required,d.minLength(8)]],dateOfBirth:["",[d.required]]})}ngOnInit(){this.invitationToken=this.route.snapshot.queryParams.token||"",this.invitationToken?this.authService.validateInvitation(this.invitationToken).subscribe({next:t=>{this.invitationValid.set(t.data??!1)},error:()=>{this.invitationValid.set(!1)}}):this.invitationValid.set(!0)}togglePassword(){this.showPassword.update(t=>!t)}onDateChange(t){let o=t.detail.value;o&&(this.registerForm.patchValue({dateOfBirth:o}),this.registerForm.get("dateOfBirth")?.markAsTouched())}onSubmit(){if(this.registerForm.invalid)return;this.isLoading.set(!0),this.errorMessage.set("");let t=w(S({},this.registerForm.value),{invitationToken:this.invitationToken||void 0});this.authService.register(t).subscribe({next:o=>{this.isLoading.set(!1),o.success?this.router.navigate(["/dashboard"]):this.errorMessage.set(o.message||"Registration failed")},error:o=>{this.isLoading.set(!1),this.errorMessage.set(o.message||"Registration failed")}})}static \u0275fac=function(o){return new(o||e)(x(V),x($),x(M),x(y))};static \u0275cmp=E({type:e,selectors:[["app-register"]],decls:9,vars:1,consts:[[1,"ion-padding"],[1,"register-container"],[1,"logo-section"],["color","danger"],["fill","clear","routerLink","/auth/login"],[3,"ngSubmit","formGroup"],[1,"form-row"],["formControlName","firstName","type","text","label","First Name","labelPlacement","floating","placeholder","Enter first name"],["formControlName","lastName","type","text","label","Last Name","labelPlacement","floating","placeholder","Enter last name"],["formControlName","email","type","email","label","Email","labelPlacement","floating","placeholder","Enter your email"],["color","danger",1,"ion-padding-start"],["formControlName","username","type","text","label","Username","labelPlacement","floating","placeholder","Choose a username"],["formControlName","password","label","Password","labelPlacement","floating","placeholder","Create a password",3,"type"],["fill","clear","slot","end",3,"click"],[3,"name"],["datetime","dob"],[3,"keepContentsMounted"],["type","submit","expand","block",1,"ion-margin-top",3,"disabled"],["name","crescent"],[1,"login-link","ion-text-center","ion-margin-top"],["slot","start","name","log-in-outline"],["id","dob","presentation","date",3,"ionChange","max"],[1,"error-message"],["slot","start","name","person-add-outline"]],template:function(o,l){o&1&&(i(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"h1"),r(4,"Community Finance Tracker"),n(),i(5,"p"),r(6,"Create your account"),n()(),u(7,ae,7,0,"ion-card",3)(8,pe,39,11,"ion-card"),n()()),o&2&&(s(7),p(l.invitationValid()===!1?7:8))},dependencies:[D,k,F,T,R,N,O,U,B,j,G,A,z,H,Z,q,X,Q,K,J,W,Y,L],styles:[".register-container[_ngcontent-%COMP%]{max-width:500px;margin:0 auto;padding-top:20px}.logo-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:24px}.logo-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:var(--ion-color-primary);margin-bottom:8px}.logo-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium)}ion-card[_ngcontent-%COMP%]{margin:0}ion-card-title[_ngcontent-%COMP%]{text-align:center}.form-row[_ngcontent-%COMP%]{display:flex;gap:8px}.form-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{flex:1}ion-item[_ngcontent-%COMP%]{--padding-start: 0;margin-bottom:8px}.error-message[_ngcontent-%COMP%]{text-align:center;margin:16px 0}.login-link[_ngcontent-%COMP%]{margin-top:24px}.login-link[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:8px;color:var(--ion-color-medium)}"]})}return e})();export{Ie as RegisterPage};
