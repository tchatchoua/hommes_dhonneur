import{F as lt,G as st,a as et,b as it,h as nt,k as ot,l as at,v as rt}from"./chunk-X5J6KBJZ.js";import{A as l,Aa as B,Ba as R,C as b,Ea as z,Ga as H,Ha as G,I as M,Ja as N,K as O,Ma as q,N as E,Na as J,P as A,Qa as K,S as T,Ta as Q,Ua as W,Wa as X,Xa as Y,Za as Z,e as w,eb as tt,f as y,ga as $,h as _,i as g,j as v,ka as D,l as s,m as I,n as S,o as f,p as x,pa as U,qa as V,r as C,ra as F,s as P,t as k,u as n,v as a,w as r,x as h,xa as L,y as p,z as d,za as j}from"./chunk-CLQQFUUR.js";import"./chunk-B5Q7V33N.js";import"./chunk-7KGURMOZ.js";import"./chunk-MEY4KOAF.js";import"./chunk-K4BOZHCE.js";import"./chunk-VKOJ4YFE.js";import"./chunk-URA66MOF.js";import"./chunk-R5HL6L5F.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-L7HKPRYE.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{e as m}from"./chunk-JHI3MBHO.js";var ct=(()=>{class e{http;apiUrl=`${tt.apiUrl}/invitations`;constructor(t){this.http=t}getAll(){return this.http.get(this.apiUrl)}getById(t){return this.http.get(`${this.apiUrl}/${t}`)}validate(t){return this.http.get(`${this.apiUrl}/validate/${t}`)}create(t={}){return this.http.post(this.apiUrl,t)}cleanup(){return this.http.post(`${this.apiUrl}/cleanup`,{})}delete(t){return this.http.delete(`${this.apiUrl}/${t}`)}static \u0275fac=function(i){return new(i||e)(y(T))};static \u0275prov=w({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var ut=(e,c)=>c.id;function _t(e,c){e&1&&(n(0,"div",2),r(1,"ion-spinner",8),n(2,"p"),l(3,"Loading invitations..."),a()())}function gt(e,c){if(e&1){let t=h();n(0,"div",3),r(1,"ion-icon",9),n(2,"h3"),l(3,"No Invitations"),a(),n(4,"p"),l(5,"Send invitations to grow your community"),a(),n(6,"ion-button",5),p("click",function(){_(t);let o=d();return g(o.openAddModal())}),r(7,"ion-icon",10),l(8," Send Invitation "),a()()}}function vt(e,c){if(e&1){let t=h();n(0,"ion-button",16),p("click",function(){_(t);let o=d().$implicit,u=d(2);return g(u.copyLink(o))}),r(1,"ion-icon",17),a()}}function ft(e,c){if(e&1){let t=h();n(0,"ion-item"),r(1,"ion-icon",11),n(2,"ion-label")(3,"h2"),l(4),a(),n(5,"p"),l(6),M(7,"date"),a()(),n(8,"ion-badge",12),l(9),a(),f(10,vt,2,0,"ion-button",13),n(11,"ion-button",14),p("click",function(){let o=_(t).$implicit,u=d(2);return g(u.confirmDelete(o))}),r(12,"ion-icon",15),a()()}if(e&2){let t=c.$implicit,i=d(2);s(),x("name",t.isUsed?"checkmark-circle-outline":"time-outline")("color",t.isUsed?"success":"warning"),s(3),b("Invitation #",t.id,""),s(2),b("Expires: ",O(7,7,t.expirationDate,"medium"),""),s(2),x("color",t.isUsed?"success":i.getExpirationColor(t)),s(),b(" ",i.getInvitationStatus(t)," "),s(),C(!t.isUsed&&!i.isExpired(t)?10:-1)}}function xt(e,c){if(e&1&&(n(0,"ion-list"),P(1,ft,13,10,"ion-item",null,ut),a()),e&2){let t=d();s(),k(t.invitations())}}function ht(e,c){e&1&&r(0,"ion-spinner",8)}function It(e,c){e&1&&l(0," Create ")}function Ct(e,c){if(e&1){let t=h();n(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",5),p("click",function(){_(t);let o=d();return g(o.closeModal())}),r(4,"ion-icon",18),a()(),n(5,"ion-title"),l(6,"Create Invitation"),a(),n(7,"ion-buttons",19)(8,"ion-button",20),p("click",function(){_(t);let o=d();return g(o.createInvitation())}),f(9,ht,1,0,"ion-spinner",8)(10,It,1,0),a()()()(),n(11,"ion-content",21)(12,"div",22),r(13,"ion-icon",23),n(14,"h3"),l(15,"Generate Invitation Link"),a(),n(16,"p"),l(17,"A new invitation link will be generated that can be shared with someone to join the community."),a()()()}if(e&2){let t=d();s(8),x("disabled",t.isSaving()),s(),C(t.isSaving()?9:10)}}var Dt=(()=>{class e{invitationService;alertController;toastController;invitations=v([]);isLoading=v(!0);isSaving=v(!1);isModalOpen=v(!1);constructor(t,i,o){this.invitationService=t,this.alertController=i,this.toastController=o,et({addOutline:it,mailOutline:rt,closeOutline:ot,copyOutline:at,trashOutline:st,checkmarkCircleOutline:nt,timeOutline:lt})}ngOnInit(){this.loadInvitations()}loadInvitations(){this.isLoading.set(!0),this.invitationService.getAll().subscribe({next:t=>{t.success&&t.data&&this.invitations.set(t.data),this.isLoading.set(!1)},error:()=>{this.isLoading.set(!1)}})}refresh(t){this.loadInvitations(),setTimeout(()=>{t.target.complete()},1e3)}isExpired(t){return new Date(t.expirationDate)<new Date}getInvitationStatus(t){return t.isUsed?"Used":this.isExpired(t)?"Expired":"Pending"}getExpirationColor(t){return this.isExpired(t)?"danger":"warning"}openAddModal(){this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}createInvitation(){return m(this,null,function*(){this.isSaving.set(!0),this.invitationService.create().subscribe({next:t=>m(this,null,function*(){if(this.isSaving.set(!1),t.success&&t.data){this.closeModal(),this.loadInvitations();let i=`${window.location.origin}/auth/register?token=${t.data.token}`;yield navigator.clipboard.writeText(i),yield(yield this.toastController.create({message:"Invitation created! Link copied to clipboard.",duration:3e3,color:"success"})).present()}}),error:t=>m(this,null,function*(){this.isSaving.set(!1),console.error("Failed to create invitation:",t),yield(yield this.toastController.create({message:"Failed to create invitation",duration:2e3,color:"danger"})).present()})})})}copyLink(t){return m(this,null,function*(){let i=`${window.location.origin}/auth/register?token=${t.token}`;yield navigator.clipboard.writeText(i),yield(yield this.toastController.create({message:"Invitation link copied to clipboard",duration:2e3,color:"success"})).present()})}confirmDelete(t){return m(this,null,function*(){yield(yield this.alertController.create({header:"Delete Invitation",message:"Are you sure you want to delete this invitation?",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>{this.deleteInvitation(t)}}]})).present()})}deleteInvitation(t){return m(this,null,function*(){this.invitationService.delete(t.id).subscribe({next:i=>m(this,null,function*(){i.success&&(this.loadInvitations(),yield(yield this.toastController.create({message:"Invitation deleted",duration:2e3,color:"success"})).present())}),error:()=>m(this,null,function*(){yield(yield this.toastController.create({message:"Failed to delete invitation",duration:2e3,color:"danger"})).present()})})})}static \u0275fac=function(i){return new(i||e)(I(ct),I(X),I(Y))};static \u0275cmp=S({type:e,selectors:[["app-admin-invitations"]],decls:17,vars:2,consts:[["slot","start"],["slot","fixed",3,"ionRefresh"],[1,"loading-container"],[1,"empty-state"],["slot","fixed","vertical","bottom","horizontal","end"],[3,"click"],["name","add-outline"],[3,"didDismiss","isOpen"],["name","crescent"],["name","mail-outline"],["slot","start","name","add-outline"],["slot","start",3,"name","color"],["slot","end",3,"color"],["fill","clear","slot","end"],["fill","clear","slot","end","color","danger",3,"click"],["slot","icon-only","name","trash-outline"],["fill","clear","slot","end",3,"click"],["slot","icon-only","name","copy-outline"],["slot","icon-only","name","close-outline"],["slot","end"],[3,"click","disabled"],[1,"ion-padding"],[1,"modal-content"],["name","mail-outline",1,"modal-icon"]],template:function(i,o){i&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),r(3,"ion-menu-button"),a(),n(4,"ion-title"),l(5,"Invitations"),a()()(),n(6,"ion-content")(7,"ion-refresher",1),p("ionRefresh",function(dt){return o.refresh(dt)}),r(8,"ion-refresher-content"),a(),f(9,_t,4,0,"div",2)(10,gt,9,0,"div",3)(11,xt,3,0,"ion-list"),n(12,"ion-fab",4)(13,"ion-fab-button",5),p("click",function(){return o.openAddModal()}),r(14,"ion-icon",6),a()(),n(15,"ion-modal",7),p("didDismiss",function(){return o.closeModal()}),f(16,Ct,18,2,"ng-template"),a()()),i&2&&(s(9),C(o.isLoading()&&o.invitations().length===0?9:o.invitations().length===0?10:11),s(6),x("isOpen",o.isModalOpen()))},dependencies:[A,E,$,R,W,Q,L,G,z,H,Z,U,V,K,q,J,F,N,j,B,D],styles:[".loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;text-align:center}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;color:var(--ion-color-medium);margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:0 0 24px}.modal-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:24px}.modal-content[_ngcontent-%COMP%]   .modal-icon[_ngcontent-%COMP%]{font-size:64px;color:var(--ion-color-primary);margin-bottom:16px}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 12px;font-size:20px}.modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:0}"]})}return e})();export{Dt as AdminInvitationsPage};
