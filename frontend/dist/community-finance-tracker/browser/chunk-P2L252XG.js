import{a as pe}from"./chunk-ID5W2Q5Y.js";import{a as ue}from"./chunk-66DYWRGA.js";import{B as fe,a as le,d as se,e as me,v as ce,w as de,z as ge}from"./chunk-X5J6KBJZ.js";import{a as re}from"./chunk-BYLLDUDU.js";import{$ as T,A as l,B as P,Ba as K,D as w,E as u,Ea as Q,F as p,G as _,Ha as X,Ja as Y,M as O,Qa as Z,Sa as $,Ta as ee,Ua as te,Xa as ie,Za as ne,_ as d,_a as oe,aa as F,ba as R,ca as U,da as W,db as ae,ea as B,fa as L,ga as j,ha as k,j as C,k as I,l as a,m as g,n as x,o as v,oa as q,p as S,qa as z,r as b,ra as D,sa as G,ta as V,u as n,ua as A,v as o,va as H,w as s,xa as J,y as f,z as E}from"./chunk-CLQQFUUR.js";import"./chunk-B5Q7V33N.js";import"./chunk-7KGURMOZ.js";import"./chunk-MEY4KOAF.js";import"./chunk-K4BOZHCE.js";import"./chunk-VKOJ4YFE.js";import"./chunk-URA66MOF.js";import"./chunk-R5HL6L5F.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-L7HKPRYE.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{e as h}from"./chunk-JHI3MBHO.js";function _e(m,N){if(m&1&&(n(0,"ion-text",15)(1,"p",20),l(2),o()()),m&2){let t=E();a(2),P(t.errorMessage())}}function he(m,N){m&1&&s(0,"ion-spinner",17)}function Se(m,N){m&1&&(s(0,"ion-icon",21),l(1," Save Changes "))}var Ue=(()=>{class m{fb;authService;userService;notificationService;toastController;profileForm;isSaving=C(!1);errorMessage=C("");currentUser=O(()=>this.authService.currentUser());notificationSettings={emailNotifications:!0,pushNotifications:!0,contributionReminders:!0,debtReminders:!0};constructor(t,c,e,r,i){this.fb=t,this.authService=c,this.userService=e,this.notificationService=r,this.toastController=i,le({personOutline:ge,saveOutline:fe,notificationsOutline:de,mailOutline:ce,callOutline:me,calendarOutline:se}),this.profileForm=this.fb.group({firstName:["",[d.required]],lastName:["",[d.required]],email:["",[d.required,d.email]],username:["",[d.required,d.minLength(3)]],phoneNumber:[""]})}ngOnInit(){this.loadProfile(),this.loadNotificationSettings()}loadProfile(){let t=this.currentUser();t&&this.profileForm.patchValue({firstName:t.firstName,lastName:t.lastName,email:t.email,username:t.username,phoneNumber:t.phoneNumber||""})}loadNotificationSettings(){this.notificationService.getSettings().subscribe({next:t=>{t.success&&t.data&&(this.notificationSettings={emailNotifications:t.data.isEnabled,pushNotifications:t.data.isEnabled,contributionReminders:t.data.isEnabled,debtReminders:t.data.isEnabled})}})}saveProfile(){this.profileForm.invalid||(this.isSaving.set(!0),this.errorMessage.set(""),this.userService.updateProfile(this.profileForm.value).subscribe({next:t=>h(this,null,function*(){this.isSaving.set(!1),t.success?(yield(yield this.toastController.create({message:"Profile updated successfully",duration:2e3,color:"success"})).present(),t.data&&this.authService.updateCurrentUser(t.data)):this.errorMessage.set(t.message||"Failed to update profile")}),error:t=>{this.isSaving.set(!1),this.errorMessage.set(t.message||"Failed to update profile")}}))}saveNotificationSettings(){return h(this,null,function*(){this.notificationService.updateSettings({isEnabled:this.notificationSettings.emailNotifications}).subscribe({next:t=>h(this,null,function*(){t.success&&(yield(yield this.toastController.create({message:"Notification settings updated",duration:2e3,color:"success"})).present())})})})}static \u0275fac=function(c){return new(c||m)(g(L),g(re),g(ue),g(pe),g(ie))};static \u0275cmp=x({type:m,selectors:[["app-profile"]],decls:60,vars:13,consts:[["slot","start"],[1,"ion-padding"],[1,"profile-container"],[1,"profile-header-card"],[1,"profile-avatar"],["alt","Profile",3,"src"],[1,"role-badge"],["name","person-outline"],[3,"ngSubmit","formGroup"],[1,"form-row"],["formControlName","firstName","type","text","label","First Name","labelPlacement","floating"],["formControlName","lastName","type","text","label","Last Name","labelPlacement","floating"],["formControlName","email","type","email","label","Email","labelPlacement","floating","readonly",""],["formControlName","username","type","text","label","Username","labelPlacement","floating"],["formControlName","phone","type","tel","label","Phone Number","labelPlacement","floating"],["color","danger"],["type","submit","expand","block",1,"ion-margin-top",3,"disabled"],["name","crescent"],["name","notifications-outline"],[3,"ngModelChange","ionChange","ngModel"],[1,"error-message"],["slot","start","name","save-outline"]],template:function(c,e){if(c&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),s(3,"ion-menu-button"),o(),n(4,"ion-title"),l(5,"My Profile"),o()()(),n(6,"ion-content",1)(7,"div",2)(8,"ion-card",3)(9,"ion-card-content")(10,"div",4)(11,"ion-avatar"),s(12,"img",5),o()(),n(13,"h2"),l(14),o(),n(15,"p"),l(16),o(),n(17,"p",6),l(18),o()()(),n(19,"ion-card")(20,"ion-card-header")(21,"ion-card-title"),s(22,"ion-icon",7),l(23," Personal Information "),o()(),n(24,"ion-card-content")(25,"form",8),f("ngSubmit",function(){return e.saveProfile()}),n(26,"div",9)(27,"ion-item"),s(28,"ion-input",10),o(),n(29,"ion-item"),s(30,"ion-input",11),o()(),n(31,"ion-item"),s(32,"ion-input",12),o(),n(33,"ion-item"),s(34,"ion-input",13),o(),n(35,"ion-item"),s(36,"ion-input",14),o(),v(37,_e,3,1,"ion-text",15),n(38,"ion-button",16),v(39,he,1,0,"ion-spinner",17)(40,Se,2,0),o()()()(),n(41,"ion-card")(42,"ion-card-header")(43,"ion-card-title"),s(44,"ion-icon",18),l(45," Notification Preferences "),o()(),n(46,"ion-card-content")(47,"ion-list")(48,"ion-item")(49,"ion-toggle",19),_("ngModelChange",function(i){return p(e.notificationSettings.emailNotifications,i)||(e.notificationSettings.emailNotifications=i),i}),f("ionChange",function(){return e.saveNotificationSettings()}),l(50," Email Notifications "),o()(),n(51,"ion-item")(52,"ion-toggle",19),_("ngModelChange",function(i){return p(e.notificationSettings.pushNotifications,i)||(e.notificationSettings.pushNotifications=i),i}),f("ionChange",function(){return e.saveNotificationSettings()}),l(53," Push Notifications "),o()(),n(54,"ion-item")(55,"ion-toggle",19),_("ngModelChange",function(i){return p(e.notificationSettings.contributionReminders,i)||(e.notificationSettings.contributionReminders=i),i}),f("ionChange",function(){return e.saveNotificationSettings()}),l(56," Contribution Reminders "),o()(),n(57,"ion-item")(58,"ion-toggle",19),_("ngModelChange",function(i){return p(e.notificationSettings.debtReminders,i)||(e.notificationSettings.debtReminders=i),i}),f("ionChange",function(){return e.saveNotificationSettings()}),l(59," Debt Payment Reminders "),o()()()()()()()),c&2){let r,i,M,y;a(12),S("src",((r=e.currentUser())==null?null:r.photoUrl)||"https://ionicframework.com/docs/img/demos/avatar.svg",I),a(2),w("",(i=e.currentUser())==null?null:i.firstName," ",(i=e.currentUser())==null?null:i.lastName,""),a(2),P((M=e.currentUser())==null?null:M.email),a(2),P((y=e.currentUser())==null?null:y.role),a(7),S("formGroup",e.profileForm),a(12),b(e.errorMessage()?37:-1),a(),S("disabled",e.profileForm.invalid||e.isSaving()),a(),b(e.isSaving()?39:40),a(10),u("ngModel",e.notificationSettings.emailNotifications),a(3),u("ngModel",e.notificationSettings.pushNotifications),a(3),u("ngModel",e.notificationSettings.contributionReminders),a(3),u("ngModel",e.notificationSettings.debtReminders)}},dependencies:[k,U,T,F,W,B,j,R,K,te,ee,J,G,A,H,V,Q,oe,z,ne,$,Z,q,X,ae,D,Y],styles:[".profile-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.profile-header-card[_ngcontent-%COMP%]{text-align:center}.profile-header-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:24px}.profile-avatar[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:16px}.profile-avatar[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{width:100px;height:100px}h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin:0 0 8px}p[_ngcontent-%COMP%]{margin:0 0 4px;color:var(--ion-color-medium)}.role-badge[_ngcontent-%COMP%]{display:inline-block;background:var(--ion-color-primary);color:#fff;padding:4px 12px;border-radius:16px;font-size:12px;margin-top:8px}ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:16px}.form-row[_ngcontent-%COMP%]{display:flex;gap:8px}.form-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{flex:1}ion-item[_ngcontent-%COMP%]{--padding-start: 0;margin-bottom:8px}.error-message[_ngcontent-%COMP%]{text-align:center;margin:16px 0}"]})}return m})();export{Ue as ProfilePage};
